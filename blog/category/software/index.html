<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href="https://suneeta-mall.github.io/blog/category/software/" rel="canonical"><link href=../reproducible-ml/ rel=prev><link href=../technology/ rel=next><link rel=alternate type=application/rss+xml title="RSS feed" href=../../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../../feed_rss_updated.xml><link rel=icon href=../../../resources/site/favicon.svg><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.18"><title>Software - Random Musings - Rambling of a curious engineer & data scientist!</title><link rel=stylesheet href=../../../assets/stylesheets/main.66ac8b77.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.49ea35f2.css"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Software - Random Musings - Rambling of a curious engineer & data scientist!"><meta property=og:description content=None><meta property=og:image content=https://suneeta-mall.github.io/assets/images/social/blog/category/software.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://suneeta-mall.github.io/blog/category/software/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Software - Random Musings - Rambling of a curious engineer & data scientist!"><meta name=twitter:description content=None><meta name=twitter:image content=https://suneeta-mall.github.io/assets/images/social/blog/category/software.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#software class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> <a href=/projects/oreilly_deep_learning_at_scale/ > <strong>ðŸŽ‰ New Book Release!</strong> Check out "Deep Learning at Scale" - An O'Reilly Book </a> </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href="https://suneeta-mall.github.io/" title="Random Musings - Rambling of a curious engineer &amp; data scientist!" class="md-header__button md-logo" aria-label="Random Musings - Rambling of a curious engineer &amp; data scientist!" data-md-component="logo"> <img src=../../../resources/site/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Random Musings - Rambling of a curious engineer & data scientist! </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Software </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3m0-4.5c5 0 9.27 3.11 11 7.5-1.73 4.39-6 7.5-11 7.5S2.73 16.39 1 12c1.73-4.39 6-7.5 11-7.5M3.18 12a9.821 9.821 0 0 0 17.64 0 9.821 9.821 0 0 0-17.64 0Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../projects/oreilly_deep_learning_at_scale/ class=md-tabs__link> Projects </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../../tags/ class=md-tabs__link> Tags </a> </li> <li class=md-tabs__item> <a href=../../../talks/KGC_NY_2022/ class=md-tabs__link> Talks </a> </li> <li class=md-tabs__item> <a href=../../../poems/singularity/ class=md-tabs__link> Poems </a> </li> <li class=md-tabs__item> <a href=../../../about/ class=md-tabs__link> About Me </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href="https://suneeta-mall.github.io/" title="Random Musings - Rambling of a curious engineer &amp; data scientist!" class="md-nav__button md-logo" aria-label="Random Musings - Rambling of a curious engineer &amp; data scientist!" data-md-component="logo"> <img src=../../../resources/site/logo.svg alt=logo> </a> Random Musings - Rambling of a curious engineer & data scientist! </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Projects </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../projects/oreilly_deep_learning_at_scale/ class=md-nav__link> <span class=md-ellipsis> Deep Learning at Scale </span> </a> </li> <li class=md-nav__item> <a href=../../../projects/curious_cassie/ class=md-nav__link> <span class=md-ellipsis> Curious Cassie - The Children's Books </span> </a> </li> <li class=md-nav__item> <a href=../../../projects/feature_analysis/ class=md-nav__link> <span class=md-ellipsis> Label Noise with Clean Lab </span> </a> </li> <li class=md-nav__item> <a href=../../../projects/feature_analysis/ class=md-nav__link> <span class=md-ellipsis> Feature Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../../projects/oreilly-interactive-katacode-series-for-reproducible-ml/ class=md-nav__link> <span class=md-ellipsis> Oreilly Katacode Series </span> </a> </li> <li class=md-nav__item> <a href=../../../projects/reproducible-ml/ class=md-nav__link> <span class=md-ellipsis> Reproducible-ML </span> </a> </li> <li class=md-nav__item> <a href=../../../projects/KCD/ class=md-nav__link> <span class=md-ellipsis> KCD </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../archive/2025/ class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> <li class=md-nav__item> <a href=../../archive/2024/ class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> <li class=md-nav__item> <a href=../../archive/2023/ class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> <li class=md-nav__item> <a href=../../archive/2022/ class=md-nav__link> <span class=md-ellipsis> 2022 </span> </a> </li> <li class=md-nav__item> <a href=../../archive/2021/ class=md-nav__link> <span class=md-ellipsis> 2021 </span> </a> </li> <li class=md-nav__item> <a href=../../archive/2019/ class=md-nav__link> <span class=md-ellipsis> 2019 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ai/ class=md-nav__link> <span class=md-ellipsis> AI </span> </a> </li> <li class=md-nav__item> <a href=../book/ class=md-nav__link> <span class=md-ellipsis> Book </span> </a> </li> <li class=md-nav__item> <a href=../childrens-books/ class=md-nav__link> <span class=md-ellipsis> Children's Books </span> </a> </li> <li class=md-nav__item> <a href=../confident-learning/ class=md-nav__link> <span class=md-ellipsis> Confident-Learning </span> </a> </li> <li class=md-nav__item> <a href=../curious-cassie/ class=md-nav__link> <span class=md-ellipsis> Curious Cassie </span> </a> </li> <li class=md-nav__item> <a href=../data/ class=md-nav__link> <span class=md-ellipsis> Data </span> </a> </li> <li class=md-nav__item> <a href=../data-centric-ai/ class=md-nav__link> <span class=md-ellipsis> Data-Centric-AI </span> </a> </li> <li class=md-nav__item> <a href=../data-science/ class=md-nav__link> <span class=md-ellipsis> Data-science </span> </a> </li> <li class=md-nav__item> <a href=../deep-learning/ class=md-nav__link> <span class=md-ellipsis> Deep Learning </span> </a> </li> <li class=md-nav__item> <a href=../generative-ai/ class=md-nav__link> <span class=md-ellipsis> Generative AI </span> </a> </li> <li class=md-nav__item> <a href=../kubernetes/ class=md-nav__link> <span class=md-ellipsis> Kubernetes </span> </a> </li> <li class=md-nav__item> <a href=../llm/ class=md-nav__link> <span class=md-ellipsis> LLM </span> </a> </li> <li class=md-nav__item> <a href=../machine-learning/ class=md-nav__link> <span class=md-ellipsis> Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=../oom/ class=md-nav__link> <span class=md-ellipsis> OOM </span> </a> </li> <li class=md-nav__item> <a href=../pytorch/ class=md-nav__link> <span class=md-ellipsis> PyTorch </span> </a> </li> <li class=md-nav__item> <a href=../reproducible-ml/ class=md-nav__link> <span class=md-ellipsis> Reproducible-ml </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Software </span> </a> </li> <li class=md-nav__item> <a href=../technology/ class=md-nav__link> <span class=md-ellipsis> Technology </span> </a> </li> <li class=md-nav__item> <a href=../umap/ class=md-nav__link> <span class=md-ellipsis> UMAP </span> </a> </li> <li class=md-nav__item> <a href=../t-sne/ class=md-nav__link> <span class=md-ellipsis> t-SNE </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Talks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Talks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../talks/KGC_NY_2022/ class=md-nav__link> <span class=md-ellipsis> Knowledge Graph Conference 2022 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/KubeCon_NA_2021/ class=md-nav__link> <span class=md-ellipsis> KubeCon NA 2021 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/Kafka_Summit_APAC_2021/ class=md-nav__link> <span class=md-ellipsis> Kafka Summit APAC 2021 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/AWS_ANZ_Commuity_day_2020/ class=md-nav__link> <span class=md-ellipsis> AWS Community Day 2020 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/She_Builds_on_AWS_2020/ class=md-nav__link> <span class=md-ellipsis> AWS She Builds on AWS 2020 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/KubeCon_US_2019/ class=md-nav__link> <span class=md-ellipsis> KubeCon US 2019 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/KubernetesSydneyForum_AU_2019/ class=md-nav__link> <span class=md-ellipsis> Kubernetes Sydney 2019 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/YOW_Data_Syd_2019/ class=md-nav__link> <span class=md-ellipsis> YOW Data 2019 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/KubeCon-Europe-2018/ class=md-nav__link> <span class=md-ellipsis> KubeCon EU 2018 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/SPIE-2019/ class=md-nav__link> <span class=md-ellipsis> SPIE 2019 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/SPIE-2018/ class=md-nav__link> <span class=md-ellipsis> SPIE 2018 </span> </a> </li> <li class=md-nav__item> <a href=../../../talks/SPIE-2015/ class=md-nav__link> <span class=md-ellipsis> SPIE 2015 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Poems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Poems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../poems/singularity/ class=md-nav__link> <span class=md-ellipsis> Singularity </span> </a> </li> <li class=md-nav__item> <a href=../../../poems/life-of-ai-engineer/ class=md-nav__link> <span class=md-ellipsis> Life of AI Engineers </span> </a> </li> <li class=md-nav__item> <a href=../../../poems/my-little-butterfly/ class=md-nav__link> <span class=md-ellipsis> My little Butterfly </span> </a> </li> <li class=md-nav__item> <a href=../../../poems/breaking-thy-bias/ class=md-nav__link> <span class=md-ellipsis> Breaking Thy Bias </span> </a> </li> <li class=md-nav__item> <a href=../../../poems/daminis/ class=md-nav__link> <span class=md-ellipsis> Daminis </span> </a> </li> <li class=md-nav__item> <a href=../../../poems/one-bright-dawn/ class=md-nav__link> <span class=md-ellipsis> One Bright Dawn </span> </a> </li> <li class=md-nav__item> <a href=../../../poems/aint-no-dr-seuss/ class=md-nav__link> <span class=md-ellipsis> Aint no Dr. Seuss </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> <span class=md-ellipsis> About Me </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <div class=md-content__inner> <header class=md-typeset> <h1 id=software>Software<a class=headerlink href=#software title="Permanent link">#</a></h1> </header> <article class="md-post md-post--excerpt"> <header class=md-post__header> <nav class="md-post__authors md-typeset"> <span class=md-author> <img src=/resources/me.png alt="Suneeta Mall"> </span> </nav> <div class="md-post__meta md-meta"> <ul class=md-meta__list> <li class=md-meta__item> <time datetime="2023-11-12 00:00:00">November 12, 2023</time></li> <li class=md-meta__item> in <a href=../machine-learning/ class=md-meta__link>Machine Learning</a>, <a href=../ai/ class=md-meta__link>AI</a>, <a href=./ class=md-meta__link>Software</a></li> <li class=md-meta__item> 17 min read </li> </ul> </div> </header> <div class="md-post__content md-typeset"> <h2 id=pydra-pydantic-and-hydra-for-configuration-management-of-model-training-experiments><a href=../../2023/11/12/hydra-pydantic-config-management/ class=toclink>Pydra - Pydantic and Hydra for configuration management of model training experiments</a></h2> <p>How do you manage the configurations of your model training experiments? Having good configuration management in place improves the user experience and simplifies experiment management. Some of the indirect advantages of having a good config solution are clean, reliable, and simple application code. This is true for any software application however some applications demand higher investment on the config piece than others. One key differentiator perhaps here is how many config fields one has and how each of these relates to the other. This can get real messy real quick with deep learning experiments where the list of config and hyperparameters can rapidly grow out of hand as soon as one breaks out of adhoc experimentations.</p> <ul> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#pydra---pydantic-and-hydra-for-configuration-management-of-model-training-experiments>Pydra - Pydantic and Hydra for configuration management of model training experiments</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#context>Context</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#hydra>Hydra</a><ul> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#a-simple-non-structured-config-example>A simple non-structured config example</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#an-extension-using-structured-config>An extension using structured config</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#some-other-interesting-features-of-hydra>Some other interesting features of hydra</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#interpolation>Interpolation</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#hydra-directives>Hydra Directives</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#where-hydra-falls-short>Where Hydra falls short?</a></li> </ul> </li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#pydantic>Pydantic</a><ul> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#an-few-interesting-notes>An few interesting notes</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#can-pydantic-bridge-the-gaps-in-hydra>Can Pydantic bridge the gaps in hydra</a></li> </ul> </li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#how-well-does-this-integrate-with-other-ecosystem-tools>How well does this integrate with other ecosystem tools</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#version-config>Version config</a></li> <li><a href=../../2023/11/12/hydra-pydantic-config-management/#conclusion>Conclusion</a></li> </ul> <h3 id=context><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#context>Context</a></h3> <p>By definition model training configurations are hierarchial. For example, an experiment configuration can be broken down into data and model specifications. While these are loosely coupled specifications, they may enforce some degree of restrictions on each other e.g. model's output specification needs to be in line with data specification. A classifier network needs to output a 10 length vector if the data source is MNIST and 20 if it's PASCAL VOC. </p> <p>Overall, configuration solution for training experiments has following requirements:</p> <ol> <li>Ability to easily templatize configurations of various components of your training experiments.</li> <li>Ability to organize the configuration of training in a hierarchical fashion acknowledging the dependency and hierarchy of participating components.</li> <li>Without duplication, reuse configurations across modules wherever needed by means such as interpolation, expressions.</li> <li>Ability to compose config using templates and applying customization through overrides, environments etc.</li> <li>Being able to store and reuse the final assembled/compiled config and reproduce the experiments reliably.</li> <li>Support structured config consisting of potentially complex, canonical python types with strong validation support beyond type hint. This perhaps is optional if one is not interested in dynamic domain-specific validations - something that can not be achieved in serialized formats like yaml/json.</li> <li>Ability to version config and enforce a schema on the config specification for reliability and robustness.</li> <li>Ability to integrate easily into complex distributed launcher frameworks for both local and remote launch.</li> <li>A configuration management that nicely integrates into your echo-system of tools and is not very dictative.</li> </ol> <p>With that in mind, I evaluated a bunch of tools combination of <a href="https://hydra.cc/">Hydra</a> and <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a> stood out as a good choice. In this post, I will go over my learnings of both the tools and also talk about gaps I still see present. Lastly, put forth a tentative solution for this gap. The structure of this post is as follows:</p> <ol> <li><a href="https://hydra.cc/">Hydra</a> - its strengths and also, what I think are its weakness.</li> <li><a href="https://pydantic-docs.helpmanual.io/">Pydantic</a> - how it can be used to fill in the void of Hydra</li> <li>The missing bits of config management from Pydra i.e. both <a href="https://hydra.cc/">Hydra</a> &amp; <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a></li> <li>The solution to bridging the gap</li> <li>Conclusion</li> </ol> <p><em>Note:</em> The samples and code shared in this post are available <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management">here</a>.</p> <h3 id=hydra><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#hydra>Hydra</a></h3> <p><a href="https://hydra.cc/">Hydra</a> is a dynamic hierarchical config management tool with the ability to override parts of the config and also to compose the config through various sources (eg command line args, environment variables). It offers a nice solution to templated configurations that can be repurposed dynamically based on your objectives. Beyond rewriting rules, compositions, and interpolations to re-config templates, it also provides a mechanism to represent the config in plain old python object style and can take care of serialization and deserialization itself. On some noteworthy features side - with hydra you can fire multi-process workload on multiple instances of configurations derived from the same template source. This can be a really handy feature for many use cases including side-by-side comparisons. </p> <p>It is also extensible in a way that one can write their plugins to launch local or remote workload. Some other nice noteworthy features are runner config and callbacks. All in all, powered by <a href="https://github.com/omry/omegaconf">OmegaConf</a> this is a great tool for config management. </p> <h4 id=a-simple-non-structured-config-example><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#a-simple-non-structured-config-example>A simple non-structured config example</a></h4> <p>Let's look at a simple use of hydra for yaml based config without involving python object model for config. This example is borrowed and extended from <a href="https://hydra.cc/docs/1.0/tutorials/basic/your_first_app/composition/">a hydra sample</a>. . <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/my_app_non_structured.py">this example</a> demonstrates 3 config modules i.e. db, schema and ui assembled togather via high level <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/conf/config.yaml">config.yaml</a>. </p> <blockquote> <p><img alt src=../../../resources/pydra/basic_config.jpg> <em>Example hierarchical hydra config.</em></p> </blockquote> <p><div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dataclasses</span><span class=w> </span><span class=kn>import</span> <span class=n>dataclass</span>
<span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span>

<span class=kn>import</span><span class=w> </span><span class=nn>hydra</span>
<span class=kn>from</span><span class=w> </span><span class=nn>hydra.core.config_store</span><span class=w> </span><span class=kn>import</span> <span class=n>ConfigStore</span>
<span class=kn>from</span><span class=w> </span><span class=nn>hydra.core.hydra_config</span><span class=w> </span><span class=kn>import</span> <span class=n>HydraConfig</span>
<span class=kn>from</span><span class=w> </span><span class=nn>omegaconf</span><span class=w> </span><span class=kn>import</span> <span class=n>MISSING</span><span class=p>,</span> <span class=n>DictConfig</span><span class=p>,</span> <span class=n>OmegaConf</span>

<span class=n>log</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>


<span class=nd>@hydra</span><span class=o>.</span><span class=n>main</span><span class=p>(</span><span class=n>config_path</span><span class=o>=</span><span class=s2>&quot;conf&quot;</span><span class=p>,</span> <span class=n>config_name</span><span class=o>=</span><span class=s2>&quot;config&quot;</span><span class=p>)</span>
<span class=k>def</span><span class=w> </span><span class=nf>my_app</span><span class=p>(</span><span class=n>cfg</span><span class=p>:</span> <span class=n>DictConfig</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Type of cfg is: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=n>cfg</span><span class=p>))</span>
    <span class=n>cfg_dict</span> <span class=o>=</span> <span class=n>OmegaConf</span><span class=o>.</span><span class=n>to_container</span><span class=p>(</span><span class=n>cfg</span><span class=p>,</span> <span class=n>throw_on_missing</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>resolve</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Merged Yaml:</span><span class=se>\n</span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>OmegaConf</span><span class=o>.</span><span class=n>to_yaml</span><span class=p>(</span><span class=n>cfg</span><span class=p>))</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>cfg</span><span class=o>.</span><span class=n>db</span><span class=p>)</span>
    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>cfg</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>driver</span><span class=p>)</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>HydraConfig</span><span class=o>.</span><span class=n>get</span><span class=p>()</span><span class=o>.</span><span class=n>job</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>my_app</span><span class=p>()</span>
</code></pre></div> Sample code can be found <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/my_app_non_structured.py">here</a></p> <p>A few things happening in this script: 1. How is config loaded: The above script tells hydra to look for hierarchical config under <code>conf</code> as a base location for config directory, and <code>config.yaml</code> as top-level config specification. This setting is defaulted by python decorator <code>@hydra.main(config_path="conf", config_name="config")</code>. A user can override these settings and point the config location to another place by using <code>--config-dir</code> for the base directory and <code>--config-name</code> for top-level config.yaml as follows: <div class=highlight><pre><span></span><code>python<span class=w> </span>my_app_non_structured.py<span class=w> </span>--config-dir<span class=w> </span>conf_custom_hydra
python<span class=w> </span>my_app_non_structured.py<span class=w> </span>--config-name<span class=w> </span>config_hydra
</code></pre></div> 2. What format can I access config: Once hydra has loaded the config, it will be loaded as dict/dictionary and surfaced as <code>DictConfig</code> from <a href="https://github.com/omry/omegaconf">OmegaConf</a>. The benefit <code>DictConfig</code> is you can access the fields as variable accessors e.g. <code>cfg.db.driver</code> as shown in code above instead of dict str key access pattern. 3. Where is composition coming from: What's defined in <code>conf</code> directory is template config. Some values may be missing - which can be represented in yaml as <code>???</code>. It's also possible to override some values from the template config at runtime. An example of this is: <code>python my_app_non_structured.py db.user=suneeta</code> Here, the final used configuration that the application will see is: <div class=highlight><pre><span></span><code>db:
  driver: mysql
  user: suneeta
  pwd: secret
ui:
  create_db: true
  view: true
schema:
  database: school
  tables:
  - name: students
  - name: exams
</code></pre></div> 4. What is the final config used in my run: Hydra saves the specifics of the config used in the run in its output location. By default the output location is <code>outputs/YYYY-MM-DD/HH-MM-SS/.hydra/config.yaml</code> which can be used to rerun the same run for reproducibility. <div class=highlight><pre><span></span><code>python<span class=w> </span>my_app_non_structured.py<span class=w> </span>--config-dir<span class=o>=</span>outputs/2022-03-16/13-45-29/.hydra
</code></pre></div> Hydra also allows you to configure job and run settings, an example of such configuration is located <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/tree/master/hydra/conf_custom_hydra/hydra">here</a>. Alternatively, one can also override these settings in the main <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/conf/config_hydra.yaml">config.yaml</a> file:</p> <p><div class=highlight><pre><span></span><code><span class=nt>defaults</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">_self_</span><span class=w>  </span><span class=c1># Note: to source default of hydra config </span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>db</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>ui</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">full</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>schema</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">school</span>

<span class=nt>hydra</span><span class=p>:</span>
<span class=w>  </span><span class=nt>job</span><span class=p>:</span>
<span class=w>    </span><span class=nt>env_set</span><span class=p>:</span><span class=w> </span>
<span class=w>      </span><span class=nt>HDF5_USE_FILE_LOCKING</span><span class=p>:</span><span class=w> </span><span class=s>&quot;false&quot;</span>
<span class=w>      </span><span class=c1>## Useful for distributed train setup</span>
<span class=w>      </span><span class=c1># RANK: ${hydra.job.num}</span>
<span class=w>    </span><span class=nt>env_copy</span><span class=p>:</span><span class=w> </span><span class=c1>## Local environment copy</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">API_KEY</span><span class=w>  </span>

<span class=w>  </span><span class=nt>job_logging</span><span class=p>:</span>
<span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>    </span><span class=nt>formatters</span><span class=p>:</span>
<span class=w>      </span><span class=nt>simple</span><span class=p>:</span>
<span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=s>&quot;[%(levelname)s]</span><span class=nv> </span><span class=s>-</span><span class=nv> </span><span class=s>%(message)s&quot;</span>
<span class=w>    </span><span class=nt>handlers</span><span class=p>:</span>
<span class=w>      </span><span class=nt>console</span><span class=p>:</span>
<span class=w>        </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">logging.StreamHandler</span>
<span class=w>        </span><span class=nt>formatter</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">simple</span>
<span class=w>        </span><span class=nt>stream</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ext://sys.stdout</span>
<span class=w>    </span><span class=nt>root</span><span class=p>:</span>
<span class=w>      </span><span class=nt>handlers</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>console</span><span class="p p-Indicator">]</span>

<span class=w>    </span><span class=nt>disable_existing_loggers</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class=w>  </span><span class=nt>run</span><span class=p>:</span>
<span class=w>    </span><span class=nt>dir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">outputs/${hydra.job.name}/${now:%Y-%m-%d_%H-%M-%S}</span>
</code></pre></div> 5. Multi-run and templates: Multi-run allows users to run the multi-process workload on the same template of config but dynamically changing some values of it. Effectively, the user will be running multiple processes of the same code under different configurations. Parameter sweeps are a really good use case for when this may come in handy. In the following run, <code>multirun</code> is doing the trick triggering 3 different processes each for schema of school, support, and warehouse. <div class=highlight><pre><span></span><code>python<span class=w> </span>my_app_non_structured.py<span class=w> </span>db.user<span class=o>=</span>suneeta<span class=w> </span><span class=nv>schema</span><span class=o>=</span>school,support,warehouse<span class=w>  </span>--config-dir<span class=w> </span>conf_custom_hydra<span class=w> </span>--multirun
</code></pre></div></p> <p>Each process gets an int id assigned which the application can recognize. The index starts from 0, as shown in fig below. </p> <blockquote> <p><img alt src=../../../resources/pydra/multi-runs.jpg> <em>Example Of multi-runs.</em></p> </blockquote> <p>This is especially useful in distributed training runs where things like <a href="https://pytorch.org/tutorials/intermediate/dist_tuto.html">RANK</a> of process needs to be known. This can be easily configured using hydra as <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/conf/config_hydra.yaml#L12">following</a>: <div class=highlight><pre><span></span><code>hydra:
  job:
    env_set: 
      RANK: ${hydra.job.num}
</code></pre></div></p> <h4 id=an-extension-using-structured-config><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#an-extension-using-structured-config>An extension using structured config</a></h4> <p>If your application configs are slightly more complex and you might want object representation of your config then <a href="https://hydra.cc/">Hydra</a> provided structured config option with <code>ConfigStore</code>. An example of this is <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/my_app.py">here</a>.</p> <p>In this case, you define your config object model as follows: <div class=highlight><pre><span></span><code><span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>DBConfig</span><span class=p>:</span>
    <span class=n>user</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>MISSING</span>
    <span class=n>pwd</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>MISSING</span>
    <span class=n>driver</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>MISSING</span>
    <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>MySQLConfig</span><span class=p>(</span><span class=n>DBConfig</span><span class=p>):</span>
    <span class=n>driver</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;mysql&quot;</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>PostGreSQLConfig</span><span class=p>(</span><span class=n>DBConfig</span><span class=p>):</span>
    <span class=n>driver</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;postgresql&quot;</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>View</span><span class=p>:</span>
    <span class=n>create_db</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=n>view</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>MISSING</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>Table</span><span class=p>:</span>
    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>MISSING</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>Schema</span><span class=p>:</span>
    <span class=n>database</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;school&quot;</span>
    <span class=n>tables</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Table</span><span class=p>]</span> <span class=o>=</span> <span class=n>MISSING</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>Config</span><span class=p>:</span>
    <span class=c1># We can now annotate db as DBConfig which</span>
    <span class=c1># improves both static and dynamic type safety.</span>
    <span class=n>db</span><span class=p>:</span> <span class=n>DBConfig</span>
    <span class=n>ui</span><span class=p>:</span> <span class=n>View</span>
    <span class=n>schema</span><span class=p>:</span> <span class=n>Schema</span>
</code></pre></div> A few things noteworthy to call out here: 1. <code>MISSING</code> is the replacement of yaml equivalent of missing denoted as <code>???</code>. 2. Hydra can only work with plain old python objects and at best with <a href="https://docs.python.org/3/library/dataclasses.html">dataclasses</a> or drop-in replacements of <code>dataclasses</code>. 3. Structured config can not work with python primitives and cant serde (serialize and deserialize) canonical or complex python objects. Not even things like python pathlib <code>Path</code>. </p> <p>Once, the config object model is done, one should define <code>ConfigStore</code> and register <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/my_app.py#L57-L62">config objects</a>: <div class=highlight><pre><span></span><code>cs = ConfigStore.instance()
cs.store(name=&quot;config&quot;, node=Config)
cs.store(group=&quot;db&quot;, name=&quot;mysql&quot;, node=MySQLConfig)
cs.store(group=&quot;db&quot;, name=&quot;postgresql&quot;, node=PostGreSQLConfig)
cs.store(name=&quot;ui&quot;, node=View)
cs.store(name=&quot;schema&quot;, node=Schema)
</code></pre></div></p> <p>Here, <code>group</code> key in config registry indicates mutually exclusive groups. More about these can be found <a href="https://hydra.cc/docs/tutorials/structured_config/config_groups/">here</a>.</p> <p>How does hydra injection change then to support config store? Not by a lot, as shown in this <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/my_app.py#L75-L80">example</a>, changing <code>DictConfig</code> to your high-level config object <code>Config</code> in this case does the trick. Then, <code>OmegaConf.to_object(cfg)</code> unpacks dict config in your python object model. <div class=highlight><pre><span></span><code>@hydra.main(config_path=&quot;conf&quot;, config_name=&quot;config&quot;)
def my_app(cfg: Config) -&gt; None:    
    log.info(&quot;Type of cfg is: %s&quot;, type(cfg))
    cfg_dict = OmegaConf.to_container(cfg, throw_on_missing=False, resolve=True)

    cfg_obj = OmegaConf.to_object(cfg)
</code></pre></div></p> <p>This is all the application needs to do to move to structured config and features discussed earlier can be explored using the following commands: <div class=highlight><pre><span></span><code>python my_app.py
python my_app.py db.user=suneeta    
python my_app.py db.user=suneeta --config-dir conf_custom_hydra
# python my_app.py db.user=suneeta --config-name config_hydra
# Multi-run
python my_app.py db.user=suneeta schema=school,support,warehouse  --config-dir conf_custom_hydra --multirun
</code></pre></div> Code located <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/hydra/my_app.py">here</a></p> <p>There is another approach <a href="https://hydra.cc/">Hydra</a> offers to <a href="https://hydra.cc/docs/advanced/instantiate_objects/overview/">instantiate objects</a> through the config. This approach requires the user to know which config is object-able beforehand as unpacking them into objects requires explicit calls to <code>instantiate</code> API. An example of such use is as follows, notice fully qualified class name in <code>__target__</code> field in config:</p> <blockquote> <p><img alt src=../../../resources/pydra/instantiate.jpg> <em>Example Of instantiate objects.</em></p> </blockquote> <p>This feature, in my view, should be used sparingly as it tightly couples the config to application-specific objects. This kind of mixed-breed config handling approach is very hard to maintain and understand.</p> <h4 id=some-other-interesting-features-of-hydra><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#some-other-interesting-features-of-hydra>Some other interesting features of hydra</a></h4> <h5 id=interpolation><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#interpolation>Interpolation</a></h5> <p>Interpolation offers a means to refer to an existing config instead of duplicating it. It also allows users to use derive values obtained through string interpolation in config. An example of interpolation is shown below:</p> <blockquote> <p><img alt src=../../../resources/pydra/Interpolation.jpg> <em>Example Of instantiate objects.</em></p> </blockquote> <h5 id=hydra-directives><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#hydra-directives>Hydra Directives</a></h5> <p><a href="https://hydra.cc/">Hydra</a> allows overriding package configuration employing directives; documentation for these is <a href="https://hydra.cc/docs/1.0/advanced/overriding_packages/">here</a>. In short, they offer means to rewrite and relocate config dynamically. I think this is evil and facilitates yaml engineering. It can also be a debugging nightmare if your intended use of config is beyond standard interfaces. </p> <blockquote> <p><img alt src=../../../resources/pydra/directives-rewrites.jpg> <em>Example Of directives to rewrite config specifications.</em></p> </blockquote> <p>Talking about directives, <code>__global__</code> are quite handy in managing configuration overrides. One example is shown here on <a href="https://hydra.cc/docs/patterns/configuring_experiments/">hydra samples itself</a></p> <h4 id=where-hydra-falls-short><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#where-hydra-falls-short>Where Hydra falls short?</a></h4> <p>Overall, <a href="https://github.com/omry/omegaconf">OmegaConf</a> and <a href="https://hydra.cc/">Hydra</a> are two powerful tools for config management, however, I personally find the following shortcoming in these tools:</p> <ol> <li> <p>No support to serde (serialize and deserialize) canonical or complex python objects can be really annoying and causes more overhead for applications. Only primitive supports are a good start. </p> <p>1.1. <a href="https://github.com/omry/omegaconf">OmegaConf</a> and <a href="https://hydra.cc/">Hydra</a> does not support <code>Union</code> type in the config either.</p> </li> <li> <p>Support for structured config type is limited to plain old Python objects or dataclasses (and drop-in replacement thereof).</p> </li> <li> <p>Validation framework is a must-have in any config management framework. Anything users provide must be validated in the application for various things like type-checking, application-specific validation, constraint limits, etc. This is currently offloaded largely to application. The choice application is left with is using structured config as simple objects and performing all validation explicitly including obvious things like type checking. This is limiting in my view.</p> </li> <li> <p>Interpolation is great to have feature. Extension to this is being able to run expression-based interpolations eg list of items to the total item in the list. However, this support is lacking in <a href="https://hydra.cc/">Hydra</a> with <a href="https://github.com/omry/omegaconf/issues/91">issues</a> being raised.</p> </li> </ol> <h3 id=pydantic><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#pydantic>Pydantic</a></h3> <p><a href="https://pydantic-docs.helpmanual.io/">Pydantic</a> offers a runtime type enforcement and validation and is itself a data validation and settings management tool. It works with pure canonical python data models and provides two approaches for this: 1. <a href="https://pydantic-docs.helpmanual.io/usage/dataclasses/">Drop in replacement of dataclass</a> 2. <a href="https://pydantic-docs.helpmanual.io/usage/models/">BaseModel abstraction</a></p> <p>Through its validation framework and type checking pydantic offers schema enforcement and can serialize and deserialize objects from various formats including but not limited to yaml/json, xml, ORM, etc. Its field type support especially <a href="https://pydantic-docs.helpmanual.io/usage/types/#constrained-types">constrained types</a> are very rich and vastly simplifies application config validations. Eg can the image size be less than 0? What's the best approach to validate this? limit at config level or sprinkle that in the application where config is used?</p> <p>Overall, pydantic is a well-documented library, an example of its dataclass use is as shown <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/pydantic/model_dc.py">below</a>: <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>
<span class=kn>import</span><span class=w> </span><span class=nn>sys</span>
<span class=kn>from</span><span class=w> </span><span class=nn>pathlib</span><span class=w> </span><span class=kn>import</span> <span class=n>Path</span>
<span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Optional</span><span class=p>,</span> <span class=n>Union</span>

<span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseModel</span><span class=p>,</span> <span class=n>conint</span><span class=p>,</span> <span class=n>validator</span>
<span class=kn>from</span><span class=w> </span><span class=nn>pydantic.dataclasses</span><span class=w> </span><span class=kn>import</span> <span class=n>dataclass</span>


<span class=n>log</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>Dataset</span><span class=p>:</span>
    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>path</span><span class=p>:</span> <span class=nb>str</span>

    <span class=nd>@validator</span><span class=p>(</span><span class=s2>&quot;path&quot;</span><span class=p>)</span>
    <span class=k>def</span><span class=w> </span><span class=nf>validate_path</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>Path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
            <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;exist&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>Model</span><span class=p>:</span>
    <span class=nb>type</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>num_layers</span><span class=p>:</span> <span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
    <span class=n>width</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>)]</span>

    <span class=nd>@validator</span><span class=p>(</span><span class=s2>&quot;type&quot;</span><span class=p>)</span>
    <span class=k>def</span><span class=w> </span><span class=nf>validate_supported_type</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
        <span class=k>if</span> <span class=nb>type</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;alex&quot;</span><span class=p>,</span> <span class=s2>&quot;le&quot;</span><span class=p>]:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;type&#39; canonly be [alex, le] got: </span><span class=si>{</span><span class=nb>type</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=nb>type</span>


<span class=nd>@dataclass</span>
<span class=k>class</span><span class=w> </span><span class=nc>Config</span><span class=p>:</span>
    <span class=n>dataset</span><span class=p>:</span> <span class=n>Dataset</span>
    <span class=n>model</span><span class=p>:</span> <span class=n>Model</span>
</code></pre></div> Notice the use of the validator decorator here. This is an approach to validate for application-specific logics.</p> <p>BaseModel comes with more bells and whistles as it provides syntactic sugar of <code>Config</code> inner class that can be used to configure the behavior of a concrete implementation of BaseModels. Details of this can be found <a href="https://pydantic-docs.helpmanual.io/usage/model_config/">here</a>. Some of the settings like <code>anystr_lower</code> and <code>use_enum_values</code> are so handy. Who does not want to work with case insensitive configurations but keep the application clear of case conversions? Like BCE and bce means any different than binary cross entropy? BaseModel implementation looks like this:</p> <p><div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>Dataset</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>path</span><span class=p>:</span> <span class=nb>str</span>

    <span class=nd>@validator</span><span class=p>(</span><span class=s2>&quot;path&quot;</span><span class=p>)</span>
    <span class=k>def</span><span class=w> </span><span class=nf>validate_path</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>Path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
            <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;exist&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>

    <span class=k>class</span><span class=w> </span><span class=nc>Config</span><span class=p>:</span>
        <span class=n>title</span> <span class=o>=</span> <span class=s2>&quot;Dataset&quot;</span>
        <span class=n>max_anystr_length</span> <span class=o>=</span> <span class=mi>10</span>
        <span class=n>allow_mutation</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=n>validate_assignment</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>anystr_lower</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>validate_all</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>use_enum_values</span> <span class=o>=</span> <span class=kc>True</span> 
</code></pre></div> Full example code is located <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/pydantic/model.py">here</a></p> <p>BaseSettings is also another great feature that seeks to abstract away settings/config that is sourced from other sources like an environment variable, init files, etc. <div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>Secrets</span><span class=p>(</span><span class=n>BaseSettings</span><span class=p>):</span>
    <span class=n>api_key</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=n>env</span><span class=o>=</span><span class=s2>&quot;api_key&quot;</span><span class=p>)</span>
    <span class=n>token</span><span class=p>:</span> <span class=nb>str</span>

    <span class=k>class</span><span class=w> </span><span class=nc>Config</span><span class=p>:</span>
        <span class=c1># case_sensitive = True</span>
        <span class=n>env_nested_delimiter</span> <span class=o>=</span> <span class=s2>&quot;_&quot;</span>

        <span class=nd>@classmethod</span>
        <span class=k>def</span><span class=w> </span><span class=nf>customise_sources</span><span class=p>(</span>
            <span class=bp>cls</span><span class=p>,</span>
            <span class=n>init_settings</span><span class=p>:</span> <span class=n>SettingsSourceCallable</span><span class=p>,</span>
            <span class=n>env_settings</span><span class=p>:</span> <span class=n>SettingsSourceCallable</span><span class=p>,</span>
            <span class=n>file_secret_settings</span><span class=p>:</span> <span class=n>SettingsSourceCallable</span><span class=p>,</span>
        <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>SettingsSourceCallable</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
            <span class=k>return</span> <span class=n>env_settings</span><span class=p>,</span> <span class=n>init_settings</span><span class=p>,</span> <span class=n>file_secret_settings</span>
</code></pre></div></p> <h4 id=an-few-interesting-notes><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#an-few-interesting-notes>An few interesting notes</a></h4> <ol> <li>It's interesting to note that the validator of pydantic can be repurposed to implement derived fields. An example of this is captured <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/pydantic/dynamic.py">here</a>: The use-case being, a list of classes is already provided in config in another module say data. You want to "infer" the total number of classes from this in the model config. In this case, you can interpolate and copy over a list of classes from the data module to model but your requirement of actually only caring about total classes is unfulfilled as you cant do expression-based interpolation just yet. In this case, <code>total_classes</code> can be defined as either list of int and then the total is deduced upon validation, leaving your in config object always representing total int value and logic-based deduction happening upon validation. Example of this is as follows:</li> </ol> <p><div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Union</span>
<span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseModel</span><span class=p>,</span> <span class=n>conint</span><span class=p>,</span> <span class=n>validator</span>

<span class=k>class</span><span class=w> </span><span class=nc>Model</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
    <span class=n>total_classes</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span> <span class=n>List</span><span class=p>[</span><span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>)]]</span>

    <span class=nd>@validator</span><span class=p>(</span><span class=s2>&quot;total_classes&quot;</span><span class=p>)</span>
    <span class=k>def</span><span class=w> </span><span class=nf>validate_classes</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>total_classes</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span> <span class=n>List</span><span class=p>[</span><span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>)]])</span> <span class=o>-&gt;</span> <span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>total_classes</span><span class=p>,</span> <span class=n>List</span><span class=p>):</span>
            <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=n>total_classes</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>total_classes</span>
</code></pre></div> I have not seen any issue in the use of validator like this but unsure if this is the intended use of validator support. Also, unsure why the validator returns in the said interface. </p> <ol> <li>Hydra's benchmarking is pretty favorable (see image below). However, they dont benchmark against OmegaConf and some other related tools, see details <a href="https://github.com/samuelcolvin/pydantic/pull/3264">here</a>. </li> </ol> <blockquote> <p><img alt src=../../../resources/pydra/benchmark.jpg> <em>Hydra's benchmarks.</em></p> </blockquote> <h4 id=can-pydantic-bridge-the-gaps-in-hydra><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#can-pydantic-bridge-the-gaps-in-hydra>Can Pydantic bridge the gaps in hydra</a></h4> <p>Pydantic offers a strong validation framework something that's been missing in hydra. While drop-in replacement of pydantic dataclass works with hydra one can still miss out on the syntactical sugars of Model Config and still be limited to primitives and non Union types and more interesting constrained types of pydantic. </p> <p>It's fair to say that direct integration of hydra with pydantic is absent. The follow-up question should be, can we make it work? Sure we can :). </p> <p>An example demonstrating how <a href="https://hydra.cc/">Hydra</a> and <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a> can be used in conjunction is shown <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/pydantic_hydra/example.py">here</a>. The secret sauce of integration lies in the following:</p> <ol> <li>Giving up on the use of <code>ConfigStore</code> of hydra</li> <li>Reading the config as <code>DictConfig</code> and unpacking to Pydantic BaseModel object via dict</li> </ol> <p>In short, this is two-liner: <div class=highlight><pre><span></span><code>    <span class=n>OmegaConf</span><span class=o>.</span><span class=n>resolve</span><span class=p>(</span><span class=n>cfg</span><span class=p>)</span>
    <span class=n>r_model</span> <span class=o>=</span> <span class=n>Config</span><span class=p>(</span><span class=o>**</span><span class=n>cfg</span><span class=p>)</span>
</code></pre></div> where <code>Config</code> is a concrete implementation of <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a>'s BaseModel. The decision we make it here is configs are specified in yaml format and we leave Hydra to manage template, composition, and all the good things of non-structured config management. Upon resolution and merge of config, we deserialize with Pydantic and get all the goodies of Pydantic validation, check, etc.</p> <h3 id=how-well-does-this-integrate-with-other-ecosystem-tools><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#how-well-does-this-integrate-with-other-ecosystem-tools>How well does this integrate with other ecosystem tools</a></h3> <p>Given hydra can provide a final configuration in dict format, the configuration side can easily integrate with echo-system tools that care about configs. Given most experiment management and tracking tools support managing config as dict, this is less of a challenge. A post from <a href="https://wandb.ai/adrishd/hydra-example/reports/Configuring-W-B-Projects-with-Hydra--VmlldzoxNTA2MzQw">Weights and biases</a> goes in detail about integration. </p> <p>It's interesting to note that other features of Hydra like multirun and sweeps given they employ multi-processing may interfere with other tools employing MP techniques too. </p> <h3 id=version-config><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#version-config>Version config</a></h3> <p>Versioning is very important practice to follow if one works with large, actively evolving code base. For the same reasons as REST APIs should be versioned, docker images are versioned, library releases are versioned, and so on, application config specifications should be versioned as well. If not for incremental updates then at least for breaking changes. <a href="https://kubernetes.io/">Kubernetes</a> actually does this really well, where users can bring their resource specification of supported version and it can work with that version creating ../resources for you. There is lot more complexity in config management that Kubernetes immplements but whats transferable here in my view is:</p> <ol> <li>When creating a run, always use latest version of config.</li> <li>Have a support in place where you can migrate your old configs to latest version of config so you can reproduce [not repeat] your experiments with newer features should you need to.</li> </ol> <p><a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/blob/master/pydantic_hydra/example.py#L83-L172">This prototype</a> is a toy example to explore how to handle versioning in the config and provide a migration path for when old version config is provided. The assumption made here is, your training code only ever works with the latest version of config so the application code is simple and is always progressive. Whenever a breaking change is introduced, a new float version of config is created while the preceding version of config implements a migration path to the following version.</p> <p>Code shown below, represents Model config which has 3 versions <code>v</code> i.e. 1.0, 2.0, 3.0. Each version makes a breaking change to the previous but each concrete implementation implements a method <code>def to_next(self) -&gt; Optional[BaseModel]</code> that cracks at migrating the config to a new specification. <div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>VersionModel</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>,</span> <span class=n>abc</span><span class=o>.</span><span class=n>ABC</span><span class=p>):</span>
    <span class=n>v</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;inf&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=s2>&quot;inf&quot;</span><span class=p>),</span> <span class=n>const</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>class</span><span class=w> </span><span class=nc>Config</span><span class=p>:</span>
        <span class=n>title</span> <span class=o>=</span> <span class=s2>&quot;Model&quot;</span>
        <span class=n>allow_mutation</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=n>max_anystr_length</span> <span class=o>=</span> <span class=mi>10</span>
        <span class=n>validate_assignment</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>anystr_lower</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>validate_all</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>use_enum_values</span> <span class=o>=</span> <span class=kc>True</span>

    <span class=k>def</span><span class=w> </span><span class=nf>version</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>v</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_next_version_model</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
        <span class=n>versions</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>fake_registry</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
        <span class=n>versions</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
        <span class=n>idx</span> <span class=o>=</span> <span class=n>versions</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>v</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
        <span class=k>if</span> <span class=n>idx</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>versions</span><span class=p>):</span>
            <span class=k>return</span> <span class=kc>None</span>
        <span class=k>return</span> <span class=n>versions</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>

    <span class=k>def</span><span class=w> </span><span class=nf>next_version</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseModel</span><span class=p>:</span>
        <span class=n>next_class</span> <span class=o>=</span> <span class=n>fake_registry</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_next_version_model</span><span class=p>())</span>
        <span class=k>return</span> <span class=n>next_class</span>

    <span class=nd>@abc</span><span class=o>.</span><span class=n>abstractmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>to_next</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseModel</span><span class=p>:</span>
        <span class=k>pass</span>


<span class=k>class</span><span class=w> </span><span class=nc>Model1</span><span class=p>(</span><span class=n>VersionModel</span><span class=p>):</span>
    <span class=c1># https://pydantic-docs.helpmanual.io/usage/types/#arguments-to-constr</span>
    <span class=nb>type</span><span class=p>:</span> <span class=nb>str</span>  <span class=c1># constr(to_lower=True)</span>
    <span class=n>num_layers</span><span class=p>:</span> <span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
    <span class=n>width</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>)]</span>
    <span class=c1># v: float = Field(1.0, const=True)</span>
    <span class=n>zoom</span><span class=p>:</span> <span class=n>conint</span><span class=p>(</span><span class=n>gt</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span> <span class=o>=</span> <span class=mi>19</span>
    <span class=n>v</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=mf>1.0</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>const</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=c1># @classmethod</span>
    <span class=c1># def to_next(cls, instance: Type[VBT]) -&gt; BaseModel:</span>
    <span class=k>def</span><span class=w> </span><span class=nf>to_next</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]:</span>
        <span class=n>next_class</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>next_version</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>next_class</span> <span class=o>!=</span> <span class=n>Model2</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&quot;WTH&quot;</span><span class=p>)</span>

        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;================================================&quot;</span><span class=p>)</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;==============Migrating from 1-&gt;2 ==============&quot;</span><span class=p>)</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;================================================&quot;</span><span class=p>)</span>

        <span class=n>d</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
        <span class=n>d</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;v&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Model2</span><span class=p>(</span><span class=o>**</span><span class=n>d</span><span class=p>)</span>


<span class=k>class</span><span class=w> </span><span class=nc>Model2</span><span class=p>(</span><span class=n>Model1</span><span class=p>):</span>
    <span class=n>width</span><span class=p>:</span> <span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
    <span class=n>context</span><span class=p>:</span> <span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>256</span><span class=p>)</span> <span class=o>=</span> <span class=mi>256</span>
    <span class=c1># v: float = Field(2.0, const=True)</span>
    <span class=n>v</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=mf>2.0</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>const</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>to_next</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]:</span>
        <span class=n>next_class</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>next_version</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>next_class</span> <span class=o>!=</span> <span class=n>Model3</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&quot;WTH&quot;</span><span class=p>)</span>

        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;================================================&quot;</span><span class=p>)</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;==============Migrating from 2-&gt;3 ==============&quot;</span><span class=p>)</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;================================================&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>Model3</span><span class=p>(</span>
            <span class=n>new_context</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>context</span><span class=p>,</span>
            <span class=n>num_layers</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>num_layers</span><span class=p>,</span>
            <span class=nb>type</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>type</span><span class=p>,</span>
            <span class=n>width</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>width</span><span class=p>,</span>
            <span class=n>zoom</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>zoom</span><span class=p>,</span>
        <span class=p>)</span>

<span class=k>class</span><span class=w> </span><span class=nc>Model3</span><span class=p>(</span><span class=n>Model1</span><span class=p>):</span>
    <span class=n>new_context</span><span class=p>:</span> <span class=n>conint</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>512</span><span class=p>,</span> <span class=n>le</span><span class=o>=</span><span class=mi>1300</span><span class=p>)</span> <span class=o>=</span> <span class=mi>512</span>
    <span class=n>v</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=mf>3.0</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=mf>3.0</span><span class=p>,</span> <span class=n>const</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>to_next</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]:</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;================================================&quot;</span><span class=p>)</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;============== Latest no migration =============&quot;</span><span class=p>)</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;================================================&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=kc>None</span>
</code></pre></div> Config templates, as shown <a href="https://github.com/suneeta-mall/hydra_pydantic_config_management/tree/master/pydantic_hydra/conf/model">here</a> are versioned as well. </p> <p>Let's run through various scenarios: 1. A user wants to run a training and uses the latest config, they run <code>python example.py model=resnet_v3</code> 2. A user wants to run a training and uses the latest config but overrides some values, they run <code>python example.py model=resnet_v3 +model.zoom=25</code> 3. A user wants to re-run a training from an old config, they run <code>python example.py</code>. They use the v2 version of config and migration fails because field <code>context</code> require value is greater than or equal to 512 in v3 but used config in v2 template is 256. The user received feedback on what needs to change in config to make it work. 4. the Same user in #3 wants to re-run a training from the old config, they run <code>python example.py model.context=512</code>. They can run and the application performs the migration and the application actually only Model3 version of object config. 5. I want to expose the schema of Model config, how can I do this: <div class=highlight><pre><span></span><code>        _Models = Annotated[Union[Model1, Model2, Model3], Field(discriminator=&quot;v&quot;)]
        _schema = schema_json_of(_Models, title=&quot;Model Schema&quot;, indent=2)
</code></pre></div> This produces the following schema for model config: <div class=highlight><pre><span></span><code><span class=p>{</span>
<span class=w>  </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Model Schema&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;discriminator&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;propertyName&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;v&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;mapping&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;1.0&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;#/definitions/Model1&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;2.0&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;#/definitions/Model2&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;3.0&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;#/definitions/Model3&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>},</span>
<span class=w>  </span><span class=nt>&quot;anyOf&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;$ref&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;#/definitions/Model1&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;$ref&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;#/definitions/Model2&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;$ref&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;#/definitions/Model3&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>],</span>
<span class=w>  </span><span class=nt>&quot;definitions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;Model1&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Model&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;object&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;properties&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;v&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;V&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;const&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>1.0</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;enum&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>            </span><span class=mf>1.0</span>
<span class=w>          </span><span class=p>],</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;number&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Type&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;string&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;num_layers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Num Layers&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>3</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Width&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;zoom&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Zoom&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;default&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>19</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;exclusiveMinimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>18</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;required&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>        </span><span class=s2>&quot;type&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s2>&quot;num_layers&quot;</span>
<span class=w>      </span><span class=p>]</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Model2&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Model&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;object&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;properties&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;v&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;V&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;const&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>2.0</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;enum&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>            </span><span class=mf>2.0</span>
<span class=w>          </span><span class=p>],</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;number&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Type&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;string&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;num_layers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Num Layers&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>3</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Width&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;zoom&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Zoom&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;default&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>19</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;exclusiveMinimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>18</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Context&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;default&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>256</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>256</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;required&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>        </span><span class=s2>&quot;type&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s2>&quot;num_layers&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s2>&quot;width&quot;</span>
<span class=w>      </span><span class=p>]</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Model3&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Model&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;object&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;properties&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;v&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;V&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;const&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>3.0</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;enum&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>            </span><span class=mf>3.0</span>
<span class=w>          </span><span class=p>],</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;number&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Type&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;string&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;num_layers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Num Layers&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>3</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Width&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;zoom&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Zoom&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;default&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>19</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;exclusiveMinimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>18</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;new_context&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;New Context&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;default&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>512</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;minimum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>512</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;maximum&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1300</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;integer&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;required&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>        </span><span class=s2>&quot;type&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s2>&quot;num_layers&quot;</span>
<span class=w>      </span><span class=p>]</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></p> <h3 id=conclusion><a class=toclink href=../../2023/11/12/hydra-pydantic-config-management/#conclusion>Conclusion</a></h3> <p>It's great to have tools like <a href="https://hydra.cc/">Hydra</a> and <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a> to simplify config management and deal with validations efficiently. It would be even great if <a href="https://hydra.cc/">Hydra</a> integrates nicely with <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a> as well but at least there is a path to using these two tools together. </p> </div> </article> <nav class=md-pagination> </nav> </div> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../reproducible-ml/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Reproducible-ml"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Reproducible-ml </div> </div> </a> <a href=../technology/ class="md-footer__link md-footer__link--next" aria-label="Next: Technology"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Technology </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href="https://www.linkedin.com/in/suneeta-mall-a6a0507/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href="https://github.com/suneeta-mall" target="_blank" rel="noopener" title="github.com" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href="https://x.com/suneetamall/" target="_blank" rel="noopener" title="x.com" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg> </a> <a href="https://www.medium.com/@suneetamall" target="_blank" rel="noopener" title="www.medium.com" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262Zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg> </a> <a href="https://scholar.google.com.au/citations?hl=en&amp;user=WD712CUAAAAJ" target="_blank" rel="noopener" title="scholar.google.com.au" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M390.9 298.5s0 .1.1.1c9.2 19.4 14.4 41.1 14.4 64C405.3 445.1 338.5 512 256 512s-149.3-66.9-149.3-149.3c0-22.9 5.2-44.6 14.4-64 1.7-3.6 3.6-7.2 5.6-10.7 4.4-7.6 9.4-14.7 15-21.3 27.4-32.6 68.5-53.3 114.4-53.3 33.6 0 64.6 11.1 89.6 29.9 9.1 6.9 17.4 14.7 24.8 23.5 5.6 6.6 10.6 13.8 15 21.3 2 3.4 3.8 7 5.5 10.5zm26.4-18.8c-30.1-58.4-91-98.4-161.3-98.4s-131.2 40-161.3 98.4L0 202.7 256 0l256 202.7-94.7 77.1z"/></svg> </a> <a href="https://www.researchgate.net/profile/Suneeta_Mall3" target="_blank" rel="noopener" title="www.researchgate.net" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 32v448h448V32H0zm262.2 334.4c-6.6 3-33.2 6-50-14.2-9.2-10.6-25.3-33.3-42.2-63.6-8.9 0-14.7 0-21.4-.6v46.4c0 23.5 6 21.2 25.8 23.9v8.1c-6.9-.3-23.1-.8-35.6-.8-13.1 0-26.1.6-33.6.8v-8.1c15.5-2.9 22-1.3 22-23.9V225c0-22.6-6.4-21-22-23.9V193c25.8 1 53.1-.6 70.9-.6 31.7 0 55.9 14.4 55.9 45.6 0 21.1-16.7 42.2-39.2 47.5 13.6 24.2 30 45.6 42.2 58.9 7.2 7.8 17.2 14.7 27.2 14.7v7.3zm22.9-135c-23.3 0-32.2-15.7-32.2-32.2V167c0-12.2 8.8-30.4 34-30.4s30.4 17.9 30.4 17.9l-10.7 7.2s-5.5-12.5-19.7-12.5c-7.9 0-19.7 7.3-19.7 19.7v26.8c0 13.4 6.6 23.3 17.9 23.3 14.1 0 21.5-10.9 21.5-26.8h-17.9v-10.7h30.4c0 20.5 4.7 49.9-34 49.9zm-116.5 44.7c-9.4 0-13.6-.3-20-.8v-69.7c6.4-.6 15-.6 22.5-.6 23.3 0 37.2 12.2 37.2 34.5 0 21.9-15 36.6-39.7 36.6z"/></svg> </a> <a href="https://suneeta-mall.github.io/feed_rss_created.xml" target="_blank" rel="noopener" title="suneeta-mall.github.io" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64zm0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg> </a> <a href=mailto:suneetamall@gmail.com target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "content.tabs.link", "navigation.indexes", "navigation.instant", "navigation.instant.preview", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "toc.follow", "header.autohide", "announce.dismiss", "navigation.footer", "navigation.breadcrumbs", "navigation.expand", "navigation.sections", "navigation.tracking", "navigation.top", "search.highlight", "search.share", "toc.follow", "toc.integrate", {"git-revision-date-localized": {"enable_creation_date": true, "type": "date"}}], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.3220b9d7.min.js></script> </body> </html>